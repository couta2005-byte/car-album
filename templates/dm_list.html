<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>DM一覧 | Carbum</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>

{% include "_nav.html" %}

<main class="container">
  <h2 class="page-title">DM一覧</h2>

  {% if rooms %}
    <div class="dm-list">
      {% for r in rooms %}
        <a href="/dm/{{ r[0] }}" class="dm-item">
          <div class="dm-icon">
            {% if r[5] %}
              <img src="{{ r[5] }}" alt="">
            {% else %}
              <div class="icon-placeholder"></div>
            {% endif %}
          </div>

          <div class="dm-body">
            <div class="dm-header">
              <span class="dm-name">
                {{ r[3] if r[3] else r[2] }}
              </span>

              {% if r[7] %}
                <time class="dm-time">
                  {{ (r[7] + timedelta(hours=9)).strftime("%m/%d %H:%M") }}
                </time>
              {% endif %}
            </div>

            <div class="dm-preview">
              {{ r[6] if r[6] else "まだメッセージはありません" }}
            </div>
          </div>
        </a>
      {% endfor %}
    </div>
  {% else %}
    <p class="empty-text">DMはまだありません</p>
  {% endif %}
</main>

</body>
</html>
