<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>{{ username }} | Car Album</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>

{% include "_nav.html" %}

<main class="container">
  <h2 class="profile-name">{{ username }}</h2>

  <!-- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ± -->
  <div class="profile-box" style="margin: 12px 0;">
    <div style="display:flex; gap:16px; flex-wrap:wrap;">
      <div><strong>ãƒ¡ãƒ¼ã‚«ãƒ¼ï¼š</strong>{{ profile[0] if profile else "" }}</div>
      <div><strong>è»Šåï¼š</strong>{{ profile[1] if profile else "" }}</div>
      <div><strong>åœ°åŸŸï¼š</strong>{{ profile[2] if profile else "" }}</div>
      <div><strong>ãƒ•ã‚©ãƒ­ãƒ¼ï¼š</strong>{{ follow_count }}</div>
      <div><strong>ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼ï¼š</strong>{{ follower_count }}</div>
    </div>
    <div style="margin-top:8px;">
      <strong>è‡ªå·±ç´¹ä»‹ï¼š</strong>
      <div style="white-space:pre-wrap;">{{ profile[3] if profile else "" }}</div>
    </div>
  </div>

  <!-- è‡ªåˆ†ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãªã‚‰ç·¨é›† -->
  {% if me == username %}
  <form action="/profile/edit" method="post" class="profile-edit" style="margin:16px 0;">
    <div style="display:flex; gap:10px; flex-wrap:wrap;">
      <input name="maker" placeholder="ãƒ¡ãƒ¼ã‚«ãƒ¼" value="{{ profile[0] if profile else '' }}">
      <input name="car" placeholder="è»Šå" value="{{ profile[1] if profile else '' }}">
      <input name="region" placeholder="åœ°åŸŸ" value="{{ profile[2] if profile else '' }}">
    </div>
    <textarea name="bio" rows="3" style="width:100%; margin-top:10px;">{{ profile[3] if profile else '' }}</textarea>
    <button type="submit" style="margin-top:10px;">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°</button>
  </form>
  {% endif %}

  <!-- ãƒ•ã‚©ãƒ­ãƒ¼æ“ä½œ -->
  {% if me and me != username %}
    {% if is_following %}
      <form action="/unfollow/{{ username | urlencode }}" method="post">
        <button type="submit">ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤</button>
      </form>
    {% else %}
      <form action="/follow/{{ username | urlencode }}" method="post">
        <button type="submit">ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹</button>
      </form>
    {% endif %}
  {% endif %}

  <!-- æŠ•ç¨¿ä¸€è¦§ -->
  <div class="posts">
  {% for post in posts %}
    <article class="post-card">

      <!-- è»Šå -->
      <div class="post-car">{{ post.car }}</div>

      <!-- â˜… ã²ã¨ã“ã¨ï¼ˆãŠã™ã™ã‚ã¨å®Œå…¨åŒä½ç½®ï¼‰ -->
      {% if post.comment %}
        <div class="post-comment">{{ post.comment }}</div>
      {% endif %}

      <!-- ç”»åƒ -->
      {% if post.image %}
        <img src="{{ post.image }}" class="post-image">
      {% endif %}

      <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div class="post-actions" style="margin-top:8px; display:flex; gap:10px; align-items:center;">

        {% if me %}
          {% if post.id in liked_posts %}
            <form action="/unlike/{{ post.id }}" method="post">
              <button type="submit">â¤ï¸ {{ post.likes }}</button>
            </form>
          {% else %}
            <form action="/like/{{ post.id }}" method="post">
              <button type="submit">ğŸ¤ {{ post.likes }}</button>
            </form>
          {% endif %}
        {% else %}
          <span>ğŸ¤ {{ post.likes }}</span>
        {% endif %}

        {% if me == post.username %}
          <form action="/delete/{{ post.id }}" method="post"
                onsubmit="return confirm('ã“ã®æŠ•ç¨¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ');">
            <button type="submit">ğŸ—‘ å‰Šé™¤</button>
          </form>
        {% endif %}

      </div>
    </article>
  {% endfor %}
  </div>
</main>

</body>
</html>
