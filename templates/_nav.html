<!-- templates/_nav.html -->
<header class="header">
  <div class="header-inner">
    <a href="/" class="logo">Carbum</a>

    <nav class="nav">
      <!-- ホーム -->
      <a href="/"
         class="nav-link {% if mode=='home' %}active{% endif %}">
        ホーム
      </a>

      {% if user %}
        <!-- ランキング -->
        <a href="/ranking?period=day"
           class="nav-link {% if mode and mode.startswith('ranking') %}active{% endif %}">
          ランキング
        </a>

        <!-- DM（未読ドット） -->
        <a href="/dm"
           class="nav-link dm-nav {% if mode=='dm' %}active{% endif %}">
          DM
          {% if unread_dm %}
            <span class="dm-unread-dot"></span>
          {% endif %}
        </a>

        <!-- ✅ プロフィール（右上固定アイコン） -->
        <a href="/user/{{ user | urlencode }}"
           class="nav-avatar-wrap"
           aria-label="プロフィール">
          {% if user_icon %}
            <img src="{{ user_icon }}" alt="icon" class="nav-avatar">
          {% else %}
            <span class="nav-avatar placeholder"></span>
          {% endif %}
        </a>

        <!-- ログアウト -->
        <form action="/logout" method="post" class="logout-form">
          <button type="submit" class="logout-btn">ログアウト</button>
        </form>

      {% else %}
        <a href="/login" class="nav-link {% if mode=='login' %}active{% endif %}">ログイン</a>
        <a href="/register" class="nav-link {% if mode=='register' %}active{% endif %}">新規登録</a>
      {% endif %}
    </nav>
  </div>
</header>

<!-- like.js（必要なら） -->
<script src="/static/like.js?v=3000" defer></script>
