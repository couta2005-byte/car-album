<header class="header">
  <div class="header-inner">
    <a href="/" class="logo">Carbum</a>

    <nav class="nav">
      <a href="/" class="nav-link {% if mode=='home' %}active{% endif %}">おすすめ</a>
      <a href="/search" class="nav-link {% if mode=='search' %}active{% endif %}">検索</a>

      {% if user %}
        <a href="/following" class="nav-link {% if mode=='following' %}active{% endif %}">フォロー中</a>

        <a href="/ranking?period=day"
           class="nav-link {% if mode.startswith('ranking') %}active{% endif %}">
          ランキング
        </a>

        <!-- ✅ プロフィール：handleがあるなら /user/handle を使う -->
        <a href="/user/{{ (me_handle if me_handle else user) | urlencode }}"
           class="nav-link {% if mode=='profile' %}active{% endif %}">
          プロフィール
        </a>

        <form action="/logout" method="post" style="display:inline;">
          <button type="submit" class="logout-btn">ログアウト</button>
        </form>
      {% else %}
        <a href="/login" class="nav-link">ログイン</a>
        <a href="/register" class="nav-link">新規登録</a>
      {% endif %}
    </nav>
  </div>
</header>

<!-- ✅ 全ページ共通：いいねJS（ここ1回だけ） -->
<script src="/static/like.js?v=3000" defer></script>
